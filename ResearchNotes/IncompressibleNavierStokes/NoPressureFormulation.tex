\documentclass{article}
\input{../../preamble.tex}

\author{Truman E. Ellis}
\title{Pressureless Navier-Stokes Formulation}

\begin{document}
\maketitle

We can derive the compressible Navier-Stokes equations in terms of the Cauchy stress tensor.
Note that
\begin{equation*}
  \sigma_{ij}=2\mu\varepsilon_{ij}+\lambda\varepsilon_{kk}\delta_{ij}\,,
\end{equation*}
and
\begin{align*}
  \sigma_{ii}&=2\mu\varepsilon_{ii}+N\lambda\varepsilon_{ii}\\
  &=(2\mu+N\lambda)\varepsilon_{ii}\,,
\end{align*}
where $N$ is the dimension.
Then
\begin{align*}
  \varepsilon_{ij}&=\frac{1}{2\mu}\sigma_{ij}-\frac{\lambda}{2\mu}\varepsilon_{kk}\delta_{ij}\\
  &=\frac{1}{2\mu}\sigma_{ij}-\frac{\lambda}{2\mu(2\mu+N\lambda)}\sigma_{kk}\delta_{ij}\\
  &=\frac{1}{2\mu}\sigma_{ij}-\frac{1}{2\mu(\frac{2\mu}{\lambda}+N)}\sigma_{kk}\delta_{ij}\,.
\end{align*}

\section*{Incompressible}
If we assume an incompressible medium, then $\lambda\rightarrow\infty$ and
\begin{align*}
  \varepsilon_{ij}&=\frac{1}{2\mu}\sigma_{ij}-\frac{1}{2N\mu}\sigma_{kk}\delta_{ij}\\
  &=\frac{1}{2\mu}\LRs{\sigma_{ij}-\frac{1}{N}\sigma_{kk}\delta_{ij}}\,.
\end{align*}
This embeds the zero divergence condition. If we take the trace of both sides, we get
\begin{align*}
  \Div\bfu=\varepsilon_{ii}=\frac{1}{2\mu}\LRs{\sigma_{ii}-\sigma_{ii}}=0\,.
\end{align*}
Pressure, though not explicitly used in this formulation, is defined as
\begin{equation*}
p=\lambda\Div\bfu-\frac{1}{N}\sigma_{ii}=\frac{1}{N}\sigma_{ii}\,.
\end{equation*}
The space-time form of the Cauchy momentum equation is
\begin{equation*}
\Divxt\vecttwo{\rho\bfu\otimes\bfu-\bfsigma}{\rho\bfu}=\bff\,.
\end{equation*}
Our incompressible Navier-Stokes sytem is then
\begin{align*}
\frac{1}{\mu}\bfsigma-\frac{1}{N\mu}\trace(\bfsigma)\bfI-\LRp{\Grad\bfu+\LRp{\Grad\bfu}^T}&=0\\
\Divxt\vecttwo{\rho\bfu\otimes\bfu-\bfsigma}{\rho\bfu}&=\bff\,.
\end{align*}
We multiply by test functions $\bftau$ (symmetric tensor) and $\bfv$ and integrate by parts over a space-time element $K$.
\begin{align*}
\LRp{\frac{1}{\mu}\bfsigma,\bftau}-\LRp{\frac{1}{N\mu}\trace(\bfsigma)\bfI,\bftau}+\LRp{2\bfu,\Div\bftau}-\LRa{2\hat\bfu,\bftau\cdot\bfn_x}&=0\\
-\LRp{\vecttwo{\rho\bfu\otimes\bfu-\bfsigma}{\rho\bfu},\Gradxt\bfv}+\LRa{\hat\bft,\bfv}&=\LRp{\bff,\bfv}\,,
\end{align*}
where 
\begin{equation*}
\begin{aligned}
\hat\bfu&=\trace(\bfu)\\
\hat\bft&=\trace\LRp{\rho\bfu\otimes\bfu-\bfsigma}\cdot\bfn_x
+\trace\LRp{\rho\bfu} n_t\,.
\end{aligned}
\end{equation*}

\subsection*{Linearization}
The Jacobian is
\begin{align*}
&\LRp{\frac{1}{\mu}\bfsigma,\bftau}-\LRp{\frac{1}{N\mu}\trace(\bfsigma)\bfI,\bftau}+\LRp{2\bfu,\Div\bftau}-\LRa{2\hat\bfu,\bftau\cdot\bfn_x}\\
&-\LRp{\vecttwo{\rho\Delta\bfu\otimes\tilde\bfu+\rho\tilde\bfu\otimes\Delta\bfu-\bfsigma}{\rho\Delta\bfu},\Gradxt\bfv}+\LRa{\hat\bft,\bfv}\,,
\end{align*}
with residual
\begin{align*}
\LRp{2\tilde\bfu,\Div\bftau}
-\LRp{\rho\tilde\bfu\otimes\tilde\bfu,\Grad\bfv}-\LRp{\bff,\bfv}\,.
\end{align*}

\subsection*{Test Norm}
For the following discussion, we drop $\rho$ (or assume $\rho=1$).
Note that $\bfsigma^d=\bfsigma-\frac{1}{N}\trace(\bfsigma)\bfI$, and $\bfsigma^d\bftau=\bfsigma\bftau^d$.
Also note that 
\[
(\Delta\bfu\otimes\tilde\bfu+\tilde\bfu\otimes\Delta\bfu)\Grad\bfv=\tilde\bfu\cdot\LRp{\Grad\bfv+\LRp{\Grad\bfv}^T}\bfu\,,
\]
since
\begin{align*}
  \LRp{\tilde u_i u_j+u_i\tilde u_j}v_{i,j}&=\tilde u_i u_j v_{i,j}+u_i \tilde u_j v_{i,j}\\
  &=\tilde u_j u_i v_{j,i}+u_i \tilde u_j v_{i,j}\\
  &=u_i(\tilde u_j(v_{i,j}+v_{j,i}))\,.
\end{align*}
Grouping terms:
\begin{align*}
\LRp{\bfsigma,\frac{1}{\nu}\bftau^d+\Grad\bfv}\\
\LRp{\bfu,2\Div\bftau-\tilde\bfu\cdot(\Grad\bfv+(\Grad\bfv)^T)-\frac{\partial\bfv}{\partial t}}\,.
\end{align*}
% Alternatively, if we divided the first equation by $2\mu$, we would have gotten:
% \begin{align*}
% \LRp{\bfsigma,\frac{1}{2\mu}\bftau^d+\Grad\bfv}\\
% \LRp{\bfu,\Div\bftau-\tilde\bfu\cdot(\Grad\bfv+(\Grad\bfv)^T)-\frac{\partial v}{\partial t}}\,.
% \end{align*}
So our graph norm based on the first version is defined by
\begin{equation*}
\norm{\LRc{\bfv,\bftau}}^2=\norm{\frac{1}{\nu}\bftau-\frac{1}{N\nu}\trace(\bftau)\bfI+\Grad\bfv}^2
+\norm{2\Div\bftau-\tilde\bfu\cdot\LRp{\Grad\bfv+(\Grad\bfv)^T}-\frac{\partial\bfv}{\partial t}}^2
+\norm{\bfv}^2
+\norm{\bftau}^2\,.
\end{equation*}

Our robust test norm for transient convection-diffusion is 
\begin{align}
\norm{\LRp{v,\bftau}}_{V}^2 &\coloneqq
\frac{1}{\epsilon}\norm{\bftau}^2
+ \norm{\Div \bftau - \tilde\bfbeta\cdot\Gradxt v}^2 \nonumber\\
&+\norm{\tilde\bfbeta\cdot \Gradxt v}^2
+ \epsilon\norm{\Grad v}^2
+ \norm{v}^2\,,
\label{eq:robustConfusion}
\end{align}
where $\tilde\bfbeta=(\bfbeta,1)^T$.
The analogous norm for incompressible Navier-Stokes is
\begin{align*}
\norm{\LRc{\bfv,\bftau}}^2&=\frac{1}{\nu}\norm{\bftau-\frac{1}{N}\trace(\bftau)\bfI}^2
+\norm{2\Div\bftau-\tilde\bfu\cdot\LRp{\Grad\bfv+(\Grad\bfv)^T}-\frac{\partial\bfv}{\partial t}}^2\\
&\quad+\norm{\tilde\bfu\cdot\LRp{\Grad\bfv+(\Grad\bfv)^T}+\frac{\partial\bfv}{\partial t}}^2
+\nu\norm{\Grad\bfv}^2
+\norm{\bfv}^2\,.
\end{align*}

\subsection*{Boundary Conditions}
On spatial boundaries, we have access to the following terms for setting boundary conditions:
\begin{equation*}
\begin{aligned}
\hat\bfu&=\trace(\bfu)\\
\hat\bft&=\trace\LRp{\rho\bfu\otimes\bfu-\bfsigma}\cdot\bfn_x\,.
\end{aligned}
\end{equation*}
For 2D flow, we can expand the flux:
\begin{equation*}
\hat\bft=\LRs{
\begin{array}{c}
(\rho u_1u_1-\sigma_{11})n_1 + (\rho u_1u_2-\sigma_{12})n_2 \\
(\rho u_1u_2-\sigma_{12})n_1 + (\rho u_2u_2-\sigma_{22})n_2 \\
\end{array}
}
\end{equation*}
The constitutive law gives the following relations:
\begin{equation*}
\LRs{
\begin{array}{cc}
\frac{1}{2}(\sigma_{11}-\sigma_{22}) & \sigma_{12} \\
\sigma_{12} & \frac{1}{2}(\sigma_{22}-\sigma_{11}) \\
\end{array}
}
=\mu
\LRs{
\begin{array}{cc}
2\pd{u_1}{x} & \pd{u_2}{x}+\pd{u_1}{y} \\
\pd{u_2}{x}+\pd{u_1}{y} & 2\pd{u_2}{y} \\
\end{array}
}
\end{equation*}
Alternatively we can write this in terms of the implicitly present pressure,
\begin{equation*}
\LRs{
\begin{array}{cc}
\sigma_{11} & \sigma_{12} \\
\sigma_{12} & \sigma_{22} \\
\end{array}
}
=
-\LRs{
\begin{array}{cc}
p & 0 \\
0 & p \\
\end{array}
}
+
\mu
\LRs{
\begin{array}{cc}
2\pd{u_1}{x} & \pd{u_2}{x}+\pd{u_1}{y} \\
\pd{u_2}{x}+\pd{u_1}{y} & 2\pd{u_2}{y} \\
\end{array}
}
\end{equation*}
This gives the following implications:
\begin{equation*}
\begin{aligned}
\sigma_{11}=0 & \Rightarrow \pd{u_1}{x}+\pd{u_2}{y}=0 \\
\sigma_{22}=0 & \Rightarrow \pd{u_1}{x}+\pd{u_2}{y}=0 \\
\sigma_{12}=0 & \Rightarrow \pd{u_2}{x}+\pd{u_1}{y}=0 \\
\sigma_{11}=\sigma_{22} & \Rightarrow \pd{u_1}{x}=0   \\ 
& \Rightarrow \pd{u_2}{y}=0 \\
\end{aligned}
\end{equation*}
But the first two are already satisfied by continuity.
In the other direction, we get the following implications:
\begin{equation*}
\begin{aligned}
\pd{u_1}{x}=0 & \Rightarrow \sigma_{11}=\sigma_{22} \\
\pd{u_2}{y}=0 & \Rightarrow \sigma_{11}=\sigma_{22} \\
\pd{u_1}{y}=\pd{u_2}{x}=0 & \Rightarrow \sigma_{12}=0 \\
\end{aligned}
\end{equation*}

\subsubsection*{Special Cases}
Now let's consider application of boundary conditions on specific parts of the domain. First we will consider the right boundary where $\bfn=[1,0]$.
Here,
\begin{equation*}
\hat\bft=\LRs{
\begin{array}{c}
\rho u_1u_1-\sigma_{11} \\
\rho u_1u_2-\sigma_{12} \\
\end{array}
}
\end{equation*}
\begin{itemize}
  \item If $u_1=0$, then we have control over $-\sigma_{11}$ and $-\sigma_{12}$.
  \item If $u_2=0$, then we have control over $\rho u_1u_1-\sigma_{11}$ and $-\sigma_{12}$.
  \item If $\sigma_{11}=0$, then we have control over $\rho u_1u_1$ and $\rho u_1u_2-\sigma_{12}$.
  \item If $\sigma_{12}=0$, then we have control over $\rho u_1u_1-\sigma_{11}$ and $\rho u_1u_2$.
\end{itemize}

On the other hand, if $\bfn=[0,1]$ on the top boundary,
\begin{equation*}
\hat\bft=\LRs{
\begin{array}{c}
\rho u_1u_2-\sigma_{12} \\
\rho u_2u_2-\sigma_{22} \\
\end{array}
}
\end{equation*}
\begin{itemize}
  \item If $u_1=0$, then we have control over $-\sigma_{12}$ and $\rho u_2u_2-\sigma_{22}$.
  \item If $u_2=0$, then we have control over $-\sigma_{12}$ and $\rho u_2u_2-\sigma_{22}$.
  \item If $\sigma_{12}=0$, then we have control over $\rho u_1u_2$ and $\rho u_2u_2-\sigma_{22}$.
  \item If $\sigma_{22}=0$, then we have control over $\rho u_1u_2-\sigma_{12}$ and $\rho u_2u_2$.
\end{itemize}

\subsubsection*{Boundary Layer Problem}
Consider the common setup for a flat plate boundary layer problem: an \emph{inflow} boundary, a \emph{top} boundary, an \emph{upstream} boundary just upstream of the \emph{plate} boundary and an \emph{outflow} boundary. Flow is oriented left to right with the \emph{inflow} to the left and the \emph{outflow} to the right.

\paragraph*{Inflow}
We have four options for setting \emph{inflow} boundary conditions: $\hat u_1$, $\hat u_2$,
$\hat t_1=\trace(-\rho u_1u_1+\sigma_{11})$, and $\hat t_2=\trace(-\rho u_1u_2+\sigma_{12})$.
Past experience suggests assuming that $\sigma_{11}$ and $\sigma_{12}$ are negligible and setting $\hat t_1=-1$ and $\hat t_2=0$.

\paragraph*{Top and Upstream}
A symmetry condition seems appropriate here. We have access to $\hat u_1$, $\hat u_2$,
$\hat t_1=\trace(\pm\rho u_1u_2\mp\sigma_{12})$, and $\hat t_2=\trace(\pm\rho u_2u_2\mp\sigma_{22})$.
Symmetry implies that we should set $u_2=0$ which simplifies $\hat t_1=\trace(\mp\sigma_{12})$ and $\hat t_2=\trace(\mp\sigma_{22})$.
The second symmetry condition should then probably be $\hat t_1=0$.

\paragraph*{Plate}
We have access to the same variables as the \emph{upstream} boundary, but previous experience suggests setting $\hat u_1=\hat u_2=0$ to be correct.

\paragraph*{Outflow}
We have four options for setting \emph{inflow} boundary conditions: $\hat u_1$, $\hat u_2$,
$\hat t_1=\trace(\rho u_1u_1-\sigma_{11})$, and $\hat t_2=\trace(\rho u_1u_2-\sigma_{12})$.
Previously we have just set no outflow boundary condition and achieved decent results.

\paragraph*{\textcolor{red}{Problem}}
Unfortunately, the above boundary conditions seem to allow the trivial solution for all trace a field variables. 
The fluxes will alternate between -1, 0, and 1 depending on cell normals in a way consistent with local conservation. 
So clearly there is something deficient with the above boundary conditions, but the solution is not immediately obvious.
The first guess would be that we need to set an outflow condition, but the correct one is not obvious.

% \section*{Compressible}
% These ideas probably won't work for compressible flow, but this is retained for reference.
% Alternatively, if we assume the Stokes hypothesis that $\lambda=-\frac{2}{3}\mu$, we instead get
% \begin{align*}
%   \varepsilon_{ij}&=\frac{1}{2\mu}\sigma_{ij}-\frac{1}{2\mu(N-3)}\sigma_{kk}\delta_{ij}\,.
% \end{align*}

\end{document}
