\documentclass{article}
\input{../../preamble.tex}

\title{Robustness for Transient Problems}
\author{Truman E. Ellis and Jesse L. Chan}

\begin{document}
\maketitle

Assume that boundary conditions are applied on the boundary $\Gamma_0\subset \Gamma$.  Recall that, for the ultra-weak variational formulation
\[
b\LRp{\LRp{u,\uh},v} = \LRp{u,A^*_h v}_{\L} + \LRa{\uh, \jump{v}}_{\Gh\setminus \Gamma_0}
\]
we can recover
\[
\norm{u}_{\L}^2 = b(u,v^*)
\]
for conforming $v^*$ satisfying the adjoint equation
\begin{align*}
A^* v^* &= u\\
v^* &= 0 \text{ on } \Gh\setminus\Gamma_0.
\end{align*}
Together, these give necessary conditions on the test norm $\norm{\cdot}_V$ such that we have $L^2$ robustness (this gives robustness in the variable $u$; for the first order formulation, conditions for $\sigma$ must also be shown).  
\[
\norm{u}_{\L}^2 = b(u,v^*) \leq \frac{b(u,v^*)}{\norm{v^*}_V} \norm{v^*}_V \leq \norm{u}_E \norm{v^*}_V
\]
Thus, showing $\norm{v^*}_V \lesssim \norm{u}_{\L}$ gives the result that $\norm{u}_{\L} \lesssim \norm{u}_E$.  


\section{Reaction-diffusion}

Consider reaction diffusion
\begin{align*}
\pd{u}{t} + u - \epsilon \Delta u &= f\\
u &= 0 \text{ on } \Gamma_1\\
\pd{u}{n} &= 0 \text{ on } \Gamma_2\\
u(t=0) &= u_0.
\end{align*}
The adjoint equation satisfies
\begin{align*}
-\pd{v}{t} + v - \epsilon \Delta v &= u\\
v &= 0 \text{ on } \Gamma_1\\
\pd{v}{n} &= 0 \text{ on } \Gamma_2\\
v(t=T) &= 0.
\end{align*}
(The boundary conditions can be derived by taking the ultra-weak formulation and choosing boundary conditions such that the temporal flux and spatial flux terms $\LRa{\uh, \jump{\tau_n}}_{\Gamma_1}$ and $\LRa{\fnh,\jump{v}}_{\Gamma_2}$ are zero.)

We can then derive that the test norm
\[
\norm{v}_V^2 = \norm{\pd{v}{t}}^2 + \norm{v}^2 + \epsilon\norm{\Grad v}^2 
\]
provides the necessary bound $\norm{v^*}_V \lesssim \norm{u}_{\L}$.

To see, this we multiply the adjoint equation by two terms as follows:
\begin{enumerate}
\item Multiply by $v$ and integrate over $\Omega \times [0,T] = Q$ to get
\[
-\int_Q \pd{v}{t}v + \int_Q v^2 + \epsilon \int_Q \LRb{\Grad v}^2 - \epsilon \int_0^T\int_{\Gamma} \pd{v}{n}v = \int_Q uv.
\]
Noting that either $v = 0$ or $\pd{v}{n} = 0$ on the boundary removes the integral over $\Gamma$.  Next, we can factor the first term and use Young's inequality to get
\[
-\int_0^T  \pd{}{t}\int_{\Omega} v^2 + \norm{v}^2_Q + \epsilon \norm{\Grad v}^2_Q \leq \frac{1}{2}\norm{u}^2_Q + \frac{1}{2}\norm{v}^2_Q
\]
Integrating by parts the first term gives
\[
-\left.\int_{\Omega} v^2\right|_0^T + \frac{1}{2}\norm{v}^2_Q + \epsilon \norm{\Grad v}^2_Q \leq \frac{1}{2}\norm{u}^2_Q
\]
Using boundary condition $v=0$ at $t= T$ gives
\[
\frac{1}{2}\norm{v}^2_Q + \epsilon \norm{\Grad v}^2_Q \leq \int_{\Omega} v(t=0)^2 + \frac{1}{2}\norm{v}^2_Q + \epsilon \norm{\Grad v}^2_Q \leq \frac{1}{2}\norm{u}^2_Q.
\]

\item Multiply by $-\pd{v}{t}$ and integrate over $Q$.  Young's inequality changes the right hand side to 
\[
\int_Q\pd{v}{t}^2 - \int_Q v\pd{v}{t} + \epsilon\int_Q \Delta v \pd{v}{t} = \int_Q -u \pd{v}{t} \leq \frac{1}{2}\norm{u}_Q^2 + \frac{1}{2}\norm{\pd{v}{t}}_Q^2 .
\]
The term $\int_Q v\pd{v}{t}$ can be reduced to the positive contribution $\int_{\Omega}{v(t=0)}^2  $ as above.  We can then take the Laplacian term, integrate by parts in space to get
\[
\int_Q \Delta v \pd{v}{t} = \int_0^T \int_{\Omega} \Delta v \pd{v}{t} =  \int_0^T \int_{\Gamma} \pd{v}{t}\pd{v}{n} - \int_0^T \int_{\Omega}\Grad\LRp{\pd{v}{t}}\Grad v.
\]
Since either $v = 0$ or $\pd{v}{n} = 0$ on $\Gamma$, the first term disappears.  The second term can be bounded by noting
\[
- \int_0^T \int_{\Omega}\Grad\LRp{\pd{v}{t}}\Grad v = - \int_0^T \pd{}{t}\int_{\Omega}\LRb{\Grad v} ^2 = - \left.\int_{\Omega}\LRb{\Grad v}^2 \right|_0^T.
\]
Since $v = 0$ at $t=T$, $\Grad v = 0$ at $t=T$ as well, and we are left with the positive contribution $\int_{\Omega}\LRb{\Grad v(t=0)}^2$.  Then,
\[
\frac{1}{2}\norm{\pd{v}{t}}_Q^2 \leq \frac{1}{2}\norm{u}_Q.
\]
\end{enumerate}
Together, these two show that, under test norm
\[
\norm{v}_V^2 = \norm{\pd{v}{t}}^2 + \norm{v}^2 + \epsilon\norm{\Grad v}^2,
\]
the adjoint equation $v^*$ satisfies
\[
\norm{v^*}_V \lesssim \norm{u}_{\L}
\]
and thus the DPG energy norm robustly bounds the $L^2$ norm from above
\[
\norm{u}_{\L} \lesssim \norm{u}_E.
\]

\section{Convection-diffusion}

Consider convection-diffusion
\begin{align*}
\pd{u}{t} + \bfbeta\cdot\Grad u - \epsilon \Delta u &= f\\
u &= 0 \text{ on } \Gamma_{out}\\
\pd{u}{n} &= 0 \text{ on } \Gamma_{in}\\
u(t=0) &= u_0.
\end{align*}
Let $\tilde\bfbeta:=\vecttwo{\bfbeta}{1}$ and $\Gradxt:=\vecttwo{\Grad}{\pd{}{t}}$, then we can rewrite this as
\begin{align*}
\tilde\bfbeta\cdot\Gradxt u - \epsilon \Delta u &= f\\
u &= 0 \text{ on } \Gamma_{out}\\
\pd{u}{n} &= 0 \text{ on } \Gamma_{in}\\
u(t=0) &= u_0.
\end{align*}
The adjoint equation satisfies
\begin{align*}
-\tilde\bfbeta\cdot\Gradxt v - \epsilon \Delta v &= u\\
v &= 0 \text{ on } \Gamma_{in}\\
\pd{v}{n} &= 0 \text{ on } \Gamma_{out}\\
v(t=T) &= 0.
\end{align*}
(The boundary conditions can be derived by taking the ultra-weak formulation and choosing boundary conditions such that the temporal flux and spatial flux terms $\LRa{\uh, \jump{\tau_n}}_{\Gamma_{out}}$ and $\LRa{\fnh,\jump{v}}_{\Gamma_{in}}$ are zero.)
The $t=0$ and $t=T$ boundaries can be considered as an inflow and outflow boundary respectively in space-time 
and we denote $\partial Q_{in}:=\Gamma_{in}\cup t=0$ while $\partial Q_{out}:=\Gamma_{out}\cup t=T$.

We can then derive that the test norm
\[
\norm{v}_V^2 = \norm{\tilde\bfbeta\cdot\Gradxt v}^2 + \epsilon\norm{\Grad v}^2 
\]
provides the necessary bound $\norm{v^*}_V \lesssim \norm{u}_{\LQ}$.

To see this, we multiply the adjoint equation by two terms as follows:
\begin{enumerate}
\item Multiply by $-\tilde\bfbeta\cdot\Gradxt v$ and integrate over $Q$ to get
\begin{equation}
\label{eq:adj1}
\norm{\tilde\bfbeta\cdot\Gradxt v}=-\int_Q u\tilde\bfbeta\cdot\Gradxt v-\epsilon\int_Q\tilde\bfbeta\cdot\Gradxt v\Delta v\,.
\end{equation}
Note that
\begin{align*}
-\int_Q\tilde\bfbeta\cdot\Gradxt v\Delta v&=-\int_Q\tilde\bfbeta\cdot\Gradxt v\Div\Grad v \\
%
&=-\int_{\Gamma_x}\tilde\bfbeta\cdot\Gradxt v\Grad v\cdot\bfn_x
+\int_Q\Grad(\tilde\bfbeta\cdot\Gradxt v)\cdot\Grad v \\
%
&=-\int_{\Gamma_x}\tilde\bfbeta\cdot\Gradxt v\Grad v\cdot\bfn_x
+\int_Q(\Grad\tilde\bfbeta\cdot\Gradxt v)\cdot\Grad v\\
&\quad+\int_Q\tilde\bfbeta\cdot\Grad\Gradxt v\cdot\Grad v\\
%
&=-\int_{\Gamma_x}\tilde\bfbeta\cdot\Gradxt v\Grad v\cdot\bfn_x
+\int_Q(\Grad\bfbeta\cdot\Grad v)\cdot\Grad v\\
&\quad+\frac{1}{2}\int_Q\tilde\bfbeta\cdot\Gradxt(\Grad v\cdot\Grad v)\\
%
&=-\int_{\Gamma_x}\tilde\bfbeta\cdot\Gradxt v\Grad v\cdot\bfn_x
+\int_Q(\Grad\bfbeta\cdot\Grad v)\cdot\Grad v\\
&\quad+\frac{1}{2}\int_\Gamma\tilde\bfbeta\cdot\bfn(\Grad v\cdot\Grad v)
-\frac{1}{2}\int_Q\Divxt\tilde\bfbeta(\Grad v\cdot\Grad v)\\
%
&=-\int_{\Gamma_x}\tilde\bfbeta\cdot\Gradxt v\Grad v\cdot\bfn_x
+\int_Q(\Grad\bfbeta\cdot\Grad v)\cdot\Grad v\\
&\quad+\frac{1}{2}\int_\Gamma\tilde\bfbeta\cdot\bfn(\Grad v\cdot\Grad v)
-\frac{1}{2}\int_Q\Div\bfbeta(\Grad v\cdot\Grad v)\\
%
&=-\int_{\Gamma_x}\tilde\bfbeta\cdot\Gradxt v\Grad v\cdot\bfn_x
+\frac{1}{2}\int_\Gamma\tilde\bfbeta\cdot\bfn(\Grad v\cdot\Grad v)\\
&\quad+\int_Q\Grad v(\Grad\bfbeta-\frac{1}{2}\Div\bfbeta\bfI)\Grad v\\
\end{align*}
Plugging this into \eqref{eq:adj1}, we get
\begin{align*}
\norm{\tilde\bfbeta\cdot\Gradxt v}&=-\int_Q u\tilde\bfbeta\cdot\Gradxt v
+\epsilon\int_Q\Grad v(\Grad\bfbeta-\frac{1}{2}\Div\bfbeta\bfI)\Grad v\\
&\quad-\epsilon\int_{\Gamma_x}\tilde\bfbeta\cdot\Gradxt v\Grad v\cdot\bfn_x
+\epsilon\frac{1}{2}\int_\Gamma\tilde\bfbeta\cdot\bfn(\Grad v\cdot\Grad v)
\end{align*}
\end{enumerate}


\section{Robustness for transient problems given spatial robustness}

Suppose we have the transient problem
\[
\pd{u}{t} + Au = f
\]
with initial condition $u(x,0) = u_0$.  Suppose that DPG is robust under the ultra-weak variational formulation for the steady problem
\[
\LRp{u,A^*_h v}_{\L} + \LRa{\uh, \jump{v}}_{\Gamma_h\setminus \Gamma_0} = \LRp{f,v}
\]
with test norm $\norm{v}_{V}$.  Then, can we show that 
\[
\norm{v}_{V,t} \coloneqq \norm{v}_V + \norm{\pd{v}{t}}_{\L}
\]
also leads to a robust upper bound of the $L^2$ norm by the DPG energy norm?  I believe this may be possible.  The adjoint equation for robustness for the transient problem gives
\[
-\pd{v}{t} + A^*v = u
\]
with $v = 0$ at $t=T$...  


\end{document}